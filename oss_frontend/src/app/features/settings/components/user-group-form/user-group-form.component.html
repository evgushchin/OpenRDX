<!-- User Group Form Template -->
<div class="container">
  <div class="header">
    <h2>{{ (isEditMode ? 'settings.userGroups.edit' : 'settings.userGroups.create') | translate }}</h2>
  </div>

  @if (error) {
    <div class="alert alert-danger">
      {{ error }}
    </div>
  }

  @if (loading) {
    <div class="spinner-container">
      <div class="spinner-border text-primary"
           role="status">
        <span class="visually-hidden">{{ 'common.loading' | translate }}</span>
      </div>
    </div>
  } @else {
    <form [formGroup]="groupForm"
          (ngSubmit)="onSubmit()"
          class="group-form">
      <div class="form-group">
        <label for="name">{{ 'settings.userGroups.name' | translate }}</label>
        <input
          type="text"
          id="name"
          formControlName="name"
          class="form-control"
          [class.is-invalid]="isFieldInvalid('name')"
          [placeholder]="'settings.userGroups.namePlaceholder' | translate">
        @if (isFieldInvalid('name')) {
          <div class="invalid-feedback">
            {{ getErrorMessage('name') }}
          </div>
        }
      </div>

      <div class="form-group">
        <label for="description">{{ 'settings.userGroups.description' | translate }}</label>
        <textarea
          id="description"
          formControlName="description"
          class="form-control"
          rows="3"
          [placeholder]="'settings.userGroups.descriptionPlaceholder' | translate">
      </textarea>
      </div>

      <div class="form-group">
        <label for="parent">{{ 'settings.userGroups.parentGroup' | translate }}</label>
        <select
          id="parent"
          formControlName="parent"
          class="form-control">
          <option [ngValue]="null">{{ 'common.none' | translate }}</option>
          @for (group of groups; track $index) {
            <option [ngValue]="group.id">
              {{ group.name }}
            </option>
          }
        </select>
      </div>

      <div class="form-actions">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="groupForm.invalid || submitting">
          {{ (isEditMode ? 'common.update' : 'common.create') | translate }}
        </button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="onCancel()"
          [disabled]="submitting">
          {{ 'common.cancel' | translate }}
        </button>
      </div>
    </form>
  }
</div>
